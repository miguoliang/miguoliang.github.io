---
import { SEO } from 'astro-seo';

type TocItem = { text: string; slug: string };
const { toc = [] as TocItem[], title, description, image, pubDate, updatedDate, author } = Astro.props;

// 判断是否为首页
const isHomePage = Astro.url.pathname === '/';

// 默认简介描述
const profileDescription = 'Put on common scense cap to observe the world.';

// 默认 SEO 配置
const seoTitle = title || (isHomePage ? 'Guoliang Mi | System Architect - Exploring AI-Driven R&D Transformation' : 'Guoliang Mi | Blog');
const seoDescription = description || (isHomePage ? profileDescription : '');
const canonical = Astro.url.href;
const siteUrl = Astro.site || new URL(Astro.url.pathname, Astro.url.origin).origin;
const ogImage = image || new URL('/og-image.png', siteUrl).href;
---
<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<SEO
			title={seoTitle}
			description={seoDescription}
			canonical={canonical}
			openGraph={{
				basic: {
					title: seoTitle,
					type: isHomePage ? 'website' : 'article',
					image: ogImage,
					url: canonical,
				},
				optional: {
					siteName: 'Guoliang Mi',
					description: isHomePage ? profileDescription : seoDescription,
				},
				...(pubDate && {
					article: {
						publishedTime: pubDate.toISOString(),
						...(updatedDate && { modifiedTime: updatedDate.toISOString() }),
						...(author && { authors: [author] }),
					},
				}),
			}}
		/>
		<link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap-index.xml" />
	</head>
<body>
	<div class="page">
		<nav class="top-nav">
			<a class="brand" href="/">Frank Mi</a>
			<div class="nav-links">
				<a href="/blog">Blog</a>
			</div>
		</nav>
		<main>
			<slot />
		</main>
	</div>
</body>
</html>

<style>
	body {
		margin: 0;
		padding: 0;
		font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
		background: #fefefe;
		color: #111;
	}
	
	.page {
		min-height: 100vh;
		display: flex;
		flex-direction: column;
	}
	
	.top-nav {
		display: flex;
		align-items: center;
		justify-content: space-between;
		padding: 1.5rem 2rem;
		border-bottom: 1px solid #eee;
		background: rgba(255, 255, 255, 0.9);
		backdrop-filter: blur(8px);
		position: sticky;
		top: 0;
		z-index: 10;
	}
	
	.brand {
		font-weight: 600;
		font-size: 1rem;
		text-decoration: none;
		color: inherit;
		letter-spacing: 0.05em;
		text-transform: uppercase;
	}
	
	.nav-links a {
		text-decoration: none;
		color: #555;
		font-size: 0.9rem;
		margin-left: 1.5rem;
		text-transform: uppercase;
		letter-spacing: 0.08em;
	}
	
	.nav-links a:hover {
		color: #000;
	}
	
	main {
		flex: 1;
		padding: 2rem;
		width: 100%;
		max-width: 900px;
		margin: 0 auto;
	}
	
	@media (max-width: 720px) {
		.top-nav {
			padding: 1rem;
		}
	
		.nav-links a {
			margin-left: 1rem;
			font-size: 0.8rem;
		}
	
		main {
			padding: 1.5rem;
		}
	}
</style>
